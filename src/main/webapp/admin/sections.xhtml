<!DOCTYPE html>
<html xmlns="http://www.w3c.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui">
	 <h:head>
	 	<h:outputStylesheet name="primeicons/primeicons.css" library="primefaces"/>
	 </h:head>
	 <h:body>
	 	<h:form id="form">
		 	<div class="topMenu">
		 		<p:tabMenu activeIndex="0">
			 		<p:menuitem value="Sections" outcome="/admin/users.xhtml"></p:menuitem>
			        <p:menuitem value="Users" outcome="/admin/users.xhtml"></p:menuitem>
			        <p:menuitem value="Books" outcome="/admin/books.xhtml"></p:menuitem>
			        <p:menuitem value="Home" url="#{pageContext.contextPath}/home"></p:menuitem>
			    </p:tabMenu>
		 	</div>
		 	
		 	<div>
			 	<p:treeTable id="nodes" value="#{sectionService.root}" var="node" selectionMode="single"
		                     expanded="true" selection="#{sectionService.selectedNode}">
		            <p:column headerText="Name" expandedIcon="pi pi-folder-open" collapsedIcon="pi pi-folder">
		                <h:outputText value="#{node.name}"/>
		            </p:column>
		            <p:column headerText="ID">
		                <h:outputText value="#{node.id}"/>
		            </p:column>
		        </p:treeTable>
		 	</div>
		<p:ajaxStatus onstart="PF('loadingDialog').show()" onsuccess="PF('loadingDialog').hide()"/>
		 	<p:contextMenu for="nodes">
	            <p:menuitem value="Add section" onclick="PF('inputDlg').show()" />
	            <p:menuitem value="Delete section" update="nodes" action="#{sectionService.deleteNode}"/>
	        </p:contextMenu>
	        
	        <p:dialog widgetVar="loadingDialog" modal="false" draggable="false" closable="false" resizable="false" showHeader="false">
		        <div class="p-text-center">
		            <i class="pi pi-spinner loading-icon" aria-hidden="true"></i>
		        </div>
		    </p:dialog>
	 	</h:form>
	 	
	 	<p:dialog id="inputDialog" for="nodes" header="Add section" widgetVar="inputDlg" minHeight="40" width="350" showEffect="fade">
	        	<h:form>
				    <p class="p-m-0">Input section name:</p>
				    <p:inputText value="#{sectionService.sectionName}"/>
				    <p:commandButton value="OK" onclick="dialog.hide();"
				    actionListener="#{sectionService.appendNode}"/>
			    </h:form>
		</p:dialog>
			
	 </h:body>
</html>
